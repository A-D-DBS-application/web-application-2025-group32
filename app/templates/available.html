{% extends 'base.html' %}

{% block title %}Beschikbare Bureaus - Colruyt{% endblock %}

{% block hero %}
  <h1 style="margin:0;font-size:2.2rem">Beschikbare Bureaus</h1>
  <p style="margin:8px 0 0 0;opacity:0.95">{{ saved.date }} van {{ saved.start_time }} tot {{ saved.end_time }}</p>
{% endblock %}

{% block content %}
<div style="margin-bottom:16px">
  <a class="btn-secondary" href="{{ url_for('main.reserve', building_id=saved.building_id, floor=saved.floor, date=saved.date, start_time=saved.start_time, end_time=saved.end_time) }}">‚Üê Wijzig criteria</a>
</div>

<div style="display:flex;align-items:center;gap:14px;margin-bottom:18px">
  <form method="get" action="{{ url_for('main.available') }}" style="display:flex;align-items:center;gap:8px">
    <input type="hidden" name="building_id" value="{{ saved.building_id }}">
    <input type="hidden" name="floor" value="{{ saved.floor }}">
    <input type="hidden" name="date" value="{{ saved.date }}">
    <input type="hidden" name="start_time" value="{{ saved.start_time }}">
    <input type="hidden" name="end_time" value="{{ saved.end_time }}">

    <label style="font-weight:600;margin-right:6px">Filters:</label>

    <select name="monitor" aria-label="Filter monitor" style="padding:6px;border-radius:6px;border:1px solid var(--muted);background:white">
      <option value="" {% if not saved.monitor %}selected{% endif %}>Alle monitors</option>
      {% if all_screens %}
        {% for screen in all_screens %}
          <option value="{{ screen }}" {% if saved.monitor == screen %}selected{% endif %}>{{ screen }}</option>
        {% endfor %}
      {% endif %}
    </select>

    <select name="chair" aria-label="Filter stoel" style="padding:6px;border-radius:6px;border:1px solid var(--muted);background:white">
      <option value="" {% if not saved.chair %}selected{% endif %}>Alle stoelen</option>
      {% if all_chairs %}
        {% for chair in all_chairs %}
          <option value="{{ chair }}" {% if saved.chair == chair %}selected{% endif %}>{{ chair }}</option>
        {% endfor %}
      {% endif %}
    </select>

    <button class="btn" type="submit" style="padding:6px 12px">Toepassen</button>
  </form>

  <a class="btn-secondary" href="{{ url_for('main.available', building_id=saved.building_id, floor=saved.floor, date=saved.date, start_time=saved.start_time, end_time=saved.end_time) }}">Wis filters</a>
</div>

{% if desks %}
<div class="available-grid">
  <style>
    .available-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
    }
    @media (max-width: 700px) {
      .available-grid {
        grid-template-columns: 1fr;
        gap: 14px;
      }
      .card {
        padding: 14px;
      }
      .btn, .btn-secondary {
        width: 100%;
        margin-bottom: 8px;
      }
      form {
        flex-direction: column !important;
        gap: 10px !important;
        width: 100%;
      }
      select, input {
        width: 100%;
        font-size: 16px;
      }
    }
  </style>
  {% for desk in desks %}
  <div class="card">
    <h3 style="margin:0 0 10px 0;color:var(--primary)">Bureau {{ desk.desk_number }}</h3>
    <p class="small" style="margin:4px 0">Gebouw: {{ desk.building.adress }}</p>
    <p class="small" style="margin:4px 0">Verdieping: {{ desk.building.floor }}</p>
    <p class="small" style="margin:4px 0;color:var(--muted)">Dienst: {{ desk.get_dienst() }}</p>
    <p class="small" style="margin:4px 0">Scherm: {{ desk.screen or 'Niet vermeld' }}</p>
    <p class="small" style="margin:4px 0">Stoel: {{ desk.chair or 'Niet vermeld' }}</p>
    <div style="margin-top:16px">
      <a class="btn" href="{{ url_for('main.desk_detail', desk_id=desk.desk_id, building_id=saved.building_id, floor=saved.floor, date=saved.date, start_time=saved.start_time, end_time=saved.end_time) }}" style="display:block;text-align:center">Selecteer bureau</a>
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="card" style="text-align:center;padding:60px 30px">
  <p style="color:var(--muted);font-size:1.1rem">Geen beschikbare bureaus gevonden voor deze criteria.</p>
  <a class="btn" href="{{ url_for('main.reserve') }}" style="margin-top:20px;display:inline-block">Andere criteria</a>
</div>
{% endif %}
{% endblock %}