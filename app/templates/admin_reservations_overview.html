{% extends "base.html" %}

{% block title %}Reservaties Beheren - Admin{% endblock %}

{% block hero %}
<h1 style="font-size: 38px; font-weight: 800; margin: 0; letter-spacing: -0.5px;">Reservaties Beheren</h1>
<p style="color: var(--text-light); margin-top: 8px;">Ingelogd als: {{ user.user_name }} {{ user.user_last_name }} (Admin)</p>
{% endblock %}

{% block content %}
<div style="margin-bottom: 24px; display: flex; gap: 12px; align-items: center;">
    <a href="{{ url_for('home') }}" class="btn btn-ghost">Terug naar Home</a>
    <a href="{{ url_for('main.admin_create_reservation') }}" class="btn">Nieuwe Reservatie Aanmaken</a>
    {% if suspicious_count > 0 %}
    <div style="background: #fff3cd; border: 1px solid #ffc107; padding: 8px 16px; border-radius: 6px; margin-left: auto;">
        <span style="color: #856404; font-weight: 600;">⚠️ {{ suspicious_count }} verdachte reservatie{{ 's' if suspicious_count != 1 else '' }}</span>
    </div>
    {% endif %}
</div>

<div class="card">
    <h2 style="margin-top: 0;">Alle Toekomstige Reservaties</h2>
    
    {% if reservations %}
        <div style="overflow-x: auto;">
            <table>
                <thead>
                    <tr>
                        <th>Status</th>
                        <th>Gebruiker</th>
                        <th>Email</th>
                        <th>Gebouw</th>
                        <th>Bureau</th>
                        <th>Datum</th>
                        <th>Starttijd</th>
                        <th>Eindtijd</th>
                        <th>Acties</th>
                    </tr>
                </thead>
                <tbody>
                    {% for res in reservations %}
                    <tr {% if res.is_suspicious %}style="background-color: #fff3cd;"{% endif %}>
                        <td style="text-align: center;">
                            {% if res.is_suspicious %}
                            <span title="{{ res.suspicious_reasons|join(', ') }}" style="cursor: help; font-size: 20px;">⚠️</span>
                            {% else %}
                            <span style="color: #28a745; font-size: 18px;">✓</span>
                            {% endif %}
                        </td>
                        <td style="font-weight: 600; color: var(--text);">{{ res.user_name }} {{ res.user_last_name }}</td>
                        <td>{{ res.user_email }}</td>
                        <td style="text-align: center; font-weight: 600;">{{ res.building_adress }}</td>
                        <td style="text-align: center;">{{ res.desk_number }}</td>
                        <td>{{ res.starttijd.strftime('%d/%m/%Y') }}</td>
                        <td>{{ res.starttijd.strftime('%H:%M') }}</td>
                        <td>{{ res.eindtijd.strftime('%H:%M') }}</td>
                        <td>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <a href="{{ url_for('main.admin_edit_reservation', res_id=res.res_id) }}" 
                                   style="color: var(--primary); text-decoration: none; font-weight: 600; font-size: 14px;">
                                    Wijzigen
                                </a>
                                
                                <form method="POST" action="{{ url_for('main.admin_delete_reservation', res_id=res.res_id) }}" style="display:inline; margin: 0;">
                                    <button type="submit" 
                                            onclick="return confirm('Weet je zeker dat je deze reservatie wilt verwijderen?')"
                                            style="background: transparent; border: none; color: #dc3545; cursor: pointer; font-weight: 600; font-size: 14px; padding: 0; font-family: inherit;">
                                        Verwijderen
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    {% if res.is_suspicious %}
                    <tr {% if res.is_suspicious %}style="background-color: #fff3cd;"{% endif %}>
                        <td colspan="9" style="padding: 8px 16px; font-size: 13px; color: #856404;">
                            <strong>Verdachte redenen:</strong>
                            {% for reason in res.suspicious_reasons %}
                                <span style="margin-right: 12px;">• {{ reason }}</span>
                            {% endfor %}
                        </td>
                    </tr>
                    {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p style="color: var(--muted); text-align: center; padding: 40px 0;">Geen toekomstige reservaties gevonden.</p>
    {% endif %}
</div>
{% endblock %}