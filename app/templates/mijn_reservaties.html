{% extends 'base.html' %}

{% block title %}Mijn Reservaties - Colruyt{% endblock %}

{% block hero %}
  <h1 style="margin:0;font-size:2.2rem">Mijn Reservaties</h1>
  <p style="margin:8px 0 0 0;opacity:0.95">Je aankomende reservaties</p>
{% endblock %}

{% block content %}
<div class="card">
  {% if reservations and reservations|length > 0 %}
  <table class="data-table mijn-table">
    <style>
      .mijn-table th, .mijn-table td { font-size: 15px; }
      @media (max-width: 700px) {
        .mijn-table th, .mijn-table td { font-size: 13px; padding: 8px 4px; }
        .mijn-table th { white-space: nowrap; }
        .mijn-table td { word-break: break-word; }
        .card { padding: 14px; }
        .btn, .btn-secondary, button { font-size: 16px; }
        .actions-cell { flex-direction: row !important; gap: 8px !important; }
        .actions-cell .btn, .actions-cell button {
          width: auto !important;
          display: inline-flex !important;
          margin-bottom: 0 !important;
        }
        .mijn-table { display: block; overflow-x: auto; }
      }
    </style>
    <thead>
      <tr>
        <th>Reservatie ID</th>
        <th>Gebouw</th>
        <th>Verdieping</th>
        <th>Bureau</th>
        <th>Datum</th>
        <th>Begintijd</th>
        <th>Eindtijd</th>
        <th>Acties</th>
      </tr>
    </thead>
    <tbody>
      {% for r in reservations %}
      {% if r.modified_by_admin %}
      <tr>
        <td colspan="8" style="padding:8px 12px;background:#fff3cd;border-left:4px solid #ff8c00;border-bottom:none;">
          <span style="color:#ff8c00;font-weight:700;font-size:0.85rem">⚠ Deze reservatie is aangepast door de beheerder</span>
        </td>
      </tr>
      <tr style="background:#fff3cd;">
        <td style="border-left:4px solid #ff8c00;border-top:none;padding-top:4px;">{{ r.res_id }}</td>
        <td style="border-top:none;padding-top:4px;">{{ r.building_adress or '-' }}</td>
        <td style="border-top:none;padding-top:4px;">{{ r.floor if r.floor is not none else '-' }}</td>
        <td style="border-top:none;padding-top:4px;">Bureau {{ r.desk_number or '-' }}</td>
        <td style="border-top:none;padding-top:4px;">{{ r.starttijd.strftime('%d/%m/%Y') if r.starttijd else '-' }}</td>
        <td style="border-top:none;padding-top:4px;">{{ r.starttijd.strftime('%H:%M') if r.starttijd else '-' }}</td>
        <td style="border-top:none;padding-top:4px;">{{ r.eindtijd.strftime('%H:%M') if r.eindtijd else '-' }}</td>
        <td style="border-top:none;padding-top:4px;">
          <div class="actions-cell" style="display:flex;gap:8px;justify-content:center;align-items:center;flex-wrap:wrap;">
            <form method="post" action="{{ url_for('main.cancel_reservation', res_id=r.res_id) }}" onsubmit="return confirm('Weet je zeker dat je deze reservatie wilt annuleren?');" style="display:inline">
              <button type="submit" style="padding:8px 16px;font-size:0.9rem;background:#dc3545;color:white;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:all 0.2s" onmouseover="this.style.background='#c82333'" onmouseout="this.style.background='#dc3545'">✕ Annuleer</button>
            </form>
          </div>
        </td>
      </tr>
      {% else %}
      <tr>
        <td>{{ r.res_id }}</td>
        <td>{{ r.building_adress or '-' }}</td>
        <td>{{ r.floor if r.floor is not none else '-' }}</td>
        <td>Bureau {{ r.desk_number or '-' }}</td>
        <td>{{ r.starttijd.strftime('%d/%m/%Y') if r.starttijd else '-' }}</td>
        <td>{{ r.starttijd.strftime('%H:%M') if r.starttijd else '-' }}</td>
        <td>{{ r.eindtijd.strftime('%H:%M') if r.eindtijd else '-' }}</td>
        <td>
          <div class="actions-cell" style="display:flex;gap:8px;justify-content:center;align-items:center;flex-wrap:wrap;">
            <form method="post" action="{{ url_for('main.cancel_reservation', res_id=r.res_id) }}" onsubmit="return confirm('Weet je zeker dat je deze reservatie wilt annuleren?');" style="display:inline">
              <button type="submit" style="padding:8px 16px;font-size:0.9rem;background:#dc3545;color:white;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:all 0.2s" onmouseover="this.style.background='#c82333'" onmouseout="this.style.background='#dc3545'">✕ Annuleer</button>
            </form>
          </div>
        </td>
      </tr>
      {% endif %}
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div style="padding:60px 30px;text-align:center">
    <p style="color:var(--muted);font-size:1.1rem;margin-bottom:24px">Je hebt nog geen reservaties.</p>
    <a class="btn" href="{{ url_for('main.reserve') }}">Maak een reservatie</a>
  </div>
  {% endif %}
</div>

<style>
  /* Responsive design voor mobiele apparaten */
  @media (max-width: 768px) {
    .data-table {
      font-size: 0.8rem;
    }
    
    .data-table th,
    .data-table td {
      padding: 8px 4px;
      white-space: nowrap;
    }
    
    /* Maak specifieke kolommen smaller */
    .data-table th:nth-child(1), /* Reservatie ID */
    .data-table td:nth-child(1) {
      width: 50px;
      font-size: 0.75rem;
    }
    
    .data-table th:nth-child(3), /* Verdieping */
    .data-table td:nth-child(3) {
      width: 40px;
      text-align: center;
    }
    
    .data-table th:nth-child(4), /* Bureau */
    .data-table td:nth-child(4) {
      font-size: 0.75rem;
    }
    
    /* Tijd kolommen smaller */
    .data-table th:nth-child(6), /* Begintijd */
    .data-table td:nth-child(6),
    .data-table th:nth-child(7), /* Eindtijd */
    .data-table td:nth-child(7) {
      font-size: 0.75rem;
      width: 55px;
    }
    
    /* Buttons in acties kolom kleiner */
    .actions-cell button {
      padding: 6px 10px !important;
      font-size: 0.8rem !important;
    }
    
    /* Admin warning banner */
    .data-table td[colspan="8"] {
      font-size: 0.75rem;
      padding: 6px 8px !important;
    }
    
    /* Tabel scrollable maken */
    .card {
      overflow-x: auto;
    }
  }
  
  @media (max-width: 500px) {
    .data-table {
      font-size: 0.75rem;
    }
    
    .data-table th,
    .data-table td {
      padding: 6px 3px;
    }
  }
</style>
{% endblock %}